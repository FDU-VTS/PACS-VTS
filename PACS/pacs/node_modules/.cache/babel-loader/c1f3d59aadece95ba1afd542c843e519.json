{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport _invoke from 'lodash/invoke';\nimport PropTypes from 'prop-types';\nimport React, { Children, cloneElement } from 'react';\nimport ReactDOM from 'react-dom';\nimport { AutoControlledComponent as Component, doesNodeContainClick, eventStack, isBrowser, keyboardKey, META } from '../../lib';\nimport Ref from '../Ref';\n/**\n * A component that allows you to render children outside their parent.\n * @see Modal\n * @see Popup\n * @see Dimmer\n * @see Confirm\n */\n\nvar Portal = function (_Component) {\n  _inherits(Portal, _Component);\n\n  function Portal() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Portal);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Portal.__proto__ || Object.getPrototypeOf(Portal)).call.apply(_ref, [this].concat(args))), _this), _this.handleDocumentClick = function (e) {\n      var _this$props = _this.props,\n          closeOnDocumentClick = _this$props.closeOnDocumentClick,\n          closeOnRootNodeClick = _this$props.closeOnRootNodeClick;\n      if (!_this.rootNode // not mounted\n      || !_this.portalNode // no portal\n      || doesNodeContainClick(_this.triggerNode, e) // event happened in trigger (delegate to trigger handlers)\n      || doesNodeContainClick(_this.portalNode, e) // event happened in the portal\n      ) return; // ignore the click\n\n      var didClickInRootNode = doesNodeContainClick(_this.rootNode, e);\n\n      if (closeOnDocumentClick && !didClickInRootNode || closeOnRootNodeClick && didClickInRootNode) {\n        _this.close(e);\n      }\n    }, _this.handleEscape = function (e) {\n      if (!_this.props.closeOnEscape) return;\n      if (keyboardKey.getCode(e) !== keyboardKey.Escape) return;\n\n      _this.close(e);\n    }, _this.handlePortalMouseLeave = function (e) {\n      var _this$props2 = _this.props,\n          closeOnPortalMouseLeave = _this$props2.closeOnPortalMouseLeave,\n          mouseLeaveDelay = _this$props2.mouseLeaveDelay;\n      if (!closeOnPortalMouseLeave) return;\n      _this.mouseLeaveTimer = _this.closeWithTimeout(e, mouseLeaveDelay);\n    }, _this.handlePortalMouseEnter = function () {\n      // In order to enable mousing from the trigger to the portal, we need to\n      // clear the mouseleave timer that was set when leaving the trigger.\n      var closeOnPortalMouseLeave = _this.props.closeOnPortalMouseLeave;\n      if (!closeOnPortalMouseLeave) return;\n      clearTimeout(_this.mouseLeaveTimer);\n    }, _this.handleTriggerBlur = function (e) {\n      for (var _len2 = arguments.length, rest = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        rest[_key2 - 1] = arguments[_key2];\n      }\n\n      var _this$props3 = _this.props,\n          trigger = _this$props3.trigger,\n          closeOnTriggerBlur = _this$props3.closeOnTriggerBlur; // Call original event handler\n\n      _invoke.apply(undefined, [trigger, 'props.onBlur', e].concat(rest)); // do not close if focus is given to the portal\n\n\n      var didFocusPortal = _invoke(_this, 'rootNode.contains', e.relatedTarget);\n\n      if (!closeOnTriggerBlur || didFocusPortal) return;\n\n      _this.close(e);\n    }, _this.handleTriggerClick = function (e) {\n      for (var _len3 = arguments.length, rest = Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        rest[_key3 - 1] = arguments[_key3];\n      }\n\n      var _this$props4 = _this.props,\n          trigger = _this$props4.trigger,\n          closeOnTriggerClick = _this$props4.closeOnTriggerClick,\n          openOnTriggerClick = _this$props4.openOnTriggerClick;\n      var open = _this.state.open; // Call original event handler\n\n      _invoke.apply(undefined, [trigger, 'props.onClick', e].concat(rest));\n\n      if (open && closeOnTriggerClick) {\n        _this.close(e);\n      } else if (!open && openOnTriggerClick) {\n        _this.open(e);\n      }\n    }, _this.handleTriggerFocus = function (e) {\n      for (var _len4 = arguments.length, rest = Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        rest[_key4 - 1] = arguments[_key4];\n      }\n\n      var _this$props5 = _this.props,\n          trigger = _this$props5.trigger,\n          openOnTriggerFocus = _this$props5.openOnTriggerFocus; // Call original event handler\n\n      _invoke.apply(undefined, [trigger, 'props.onFocus', e].concat(rest));\n\n      if (!openOnTriggerFocus) return;\n\n      _this.open(e);\n    }, _this.handleTriggerMouseLeave = function (e) {\n      for (var _len5 = arguments.length, rest = Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n        rest[_key5 - 1] = arguments[_key5];\n      }\n\n      clearTimeout(_this.mouseEnterTimer);\n      var _this$props6 = _this.props,\n          trigger = _this$props6.trigger,\n          closeOnTriggerMouseLeave = _this$props6.closeOnTriggerMouseLeave,\n          mouseLeaveDelay = _this$props6.mouseLeaveDelay; // Call original event handler\n\n      _invoke.apply(undefined, [trigger, 'props.onMouseLeave', e].concat(rest));\n\n      if (!closeOnTriggerMouseLeave) return;\n      _this.mouseLeaveTimer = _this.closeWithTimeout(e, mouseLeaveDelay);\n    }, _this.handleTriggerMouseEnter = function (e) {\n      for (var _len6 = arguments.length, rest = Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {\n        rest[_key6 - 1] = arguments[_key6];\n      }\n\n      clearTimeout(_this.mouseLeaveTimer);\n      var _this$props7 = _this.props,\n          trigger = _this$props7.trigger,\n          mouseEnterDelay = _this$props7.mouseEnterDelay,\n          openOnTriggerMouseEnter = _this$props7.openOnTriggerMouseEnter; // Call original event handler\n\n      _invoke.apply(undefined, [trigger, 'props.onMouseEnter', e].concat(rest));\n\n      if (!openOnTriggerMouseEnter) return;\n      _this.mouseEnterTimer = _this.openWithTimeout(e, mouseEnterDelay);\n    }, _this.open = function (e) {\n      var onOpen = _this.props.onOpen;\n      if (onOpen) onOpen(e, _this.props);\n\n      _this.trySetState({\n        open: true\n      });\n    }, _this.openWithTimeout = function (e, delay) {\n      // React wipes the entire event object and suggests using e.persist() if\n      // you need the event for async access. However, even with e.persist\n      // certain required props (e.g. currentTarget) are null so we're forced to clone.\n      var eventClone = _extends({}, e);\n\n      return setTimeout(function () {\n        return _this.open(eventClone);\n      }, delay || 0);\n    }, _this.close = function (e) {\n      var onClose = _this.props.onClose;\n      if (onClose) onClose(e, _this.props);\n\n      _this.trySetState({\n        open: false\n      });\n    }, _this.closeWithTimeout = function (e, delay) {\n      // React wipes the entire event object and suggests using e.persist() if\n      // you need the event for async access. However, even with e.persist\n      // certain required props (e.g. currentTarget) are null so we're forced to clone.\n      var eventClone = _extends({}, e);\n\n      return setTimeout(function () {\n        return _this.close(eventClone);\n      }, delay || 0);\n    }, _this.attachRenderSubTreeSubscribers = function (eventPool) {\n      // Prevent race condition bug\n      // https://github.com/Semantic-Org/Semantic-UI-React/issues/2401\n      if (!_this.rootNode) return null;\n      _this.portalNode = _this.rootNode.firstElementChild;\n      eventStack.sub('mouseleave', _this.handlePortalMouseLeave, {\n        pool: eventPool,\n        target: _this.portalNode\n      });\n      eventStack.sub('mouseenter', _this.handlePortalMouseEnter, {\n        pool: eventPool,\n        target: _this.portalNode\n      });\n    }, _this.mountPortal = function () {\n      if (!isBrowser() || _this.rootNode) return;\n      var _this$props8 = _this.props,\n          eventPool = _this$props8.eventPool,\n          _this$props8$mountNod = _this$props8.mountNode,\n          mountNode = _this$props8$mountNod === undefined ? isBrowser() ? document.body : null : _this$props8$mountNod,\n          prepend = _this$props8.prepend;\n      _this.rootNode = document.createElement('div');\n\n      if (prepend) {\n        mountNode.insertBefore(_this.rootNode, mountNode.firstElementChild);\n      } else {\n        mountNode.appendChild(_this.rootNode);\n      }\n\n      eventStack.sub('click', _this.handleDocumentClick, {\n        pool: eventPool\n      });\n      eventStack.sub('keydown', _this.handleEscape, {\n        pool: eventPool\n      });\n\n      _invoke(_this.props, 'onMount', null, _this.props);\n    }, _this.unmountPortal = function () {\n      if (!isBrowser() || !_this.rootNode) return;\n      var eventPool = _this.props.eventPool;\n      ReactDOM.unmountComponentAtNode(_this.rootNode);\n\n      _this.rootNode.parentNode.removeChild(_this.rootNode);\n\n      eventStack.unsub('mouseleave', _this.handlePortalMouseLeave, {\n        pool: eventPool,\n        target: _this.portalNode\n      });\n      eventStack.unsub('mouseenter', _this.handlePortalMouseEnter, {\n        pool: eventPool,\n        target: _this.portalNode\n      });\n      _this.rootNode = null;\n      _this.portalNode = null;\n      eventStack.unsub('click', _this.handleDocumentClick, {\n        pool: eventPool\n      });\n      eventStack.unsub('keydown', _this.handleEscape, {\n        pool: eventPool\n      });\n\n      _invoke(_this.props, 'onUnmount', null, _this.props);\n    }, _this.handleRef = function (c) {\n      return _this.triggerNode = c;\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Portal, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.renderPortal();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      // NOTE: Ideally the portal rendering would happen in the render() function\n      // but React gives a warning about not being pure and suggests doing it\n      // within this method.\n      // If the portal is open, render (or re-render) the portal and child.\n      this.renderPortal();\n\n      if (prevState.open && !this.state.open) {\n        this.unmountPortal();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unmountPortal(); // Clean up timers\n\n      clearTimeout(this.mouseEnterTimer);\n      clearTimeout(this.mouseLeaveTimer);\n    } // ----------------------------------------\n    // Document Event Handlers\n    // ----------------------------------------\n    // ----------------------------------------\n    // Component Event Handlers\n    // ----------------------------------------\n    // ----------------------------------------\n    // Behavior\n    // ----------------------------------------\n\n  }, {\n    key: 'renderPortal',\n    value: function renderPortal() {\n      var _this2 = this;\n\n      if (!this.state.open) return;\n      var _props = this.props,\n          children = _props.children,\n          className = _props.className,\n          eventPool = _props.eventPool;\n      this.mountPortal(); // Server side rendering\n\n      if (!isBrowser()) return null;\n      this.rootNode.className = className || ''; // when re-rendering, first remove listeners before re-adding them to the new node\n\n      if (this.portalNode) {\n        eventStack.unsub('mouseleave', this.handlePortalMouseLeave, {\n          pool: eventPool,\n          target: this.portalNode\n        });\n        eventStack.unsub('mouseenter', this.handlePortalMouseEnter, {\n          pool: eventPool,\n          target: this.portalNode\n        });\n      }\n\n      ReactDOM.unstable_renderSubtreeIntoContainer(this, Children.only(children), this.rootNode, function () {\n        return _this2.attachRenderSubTreeSubscribers(eventPool);\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var trigger = this.props.trigger;\n      if (!trigger) return null;\n      return React.createElement(Ref, {\n        innerRef: this.handleRef\n      }, cloneElement(trigger, {\n        onBlur: this.handleTriggerBlur,\n        onClick: this.handleTriggerClick,\n        onFocus: this.handleTriggerFocus,\n        onMouseLeave: this.handleTriggerMouseLeave,\n        onMouseEnter: this.handleTriggerMouseEnter\n      }));\n    }\n  }]);\n\n  return Portal;\n}(Component);\n\nPortal.defaultProps = {\n  closeOnDocumentClick: true,\n  closeOnEscape: true,\n  eventPool: 'default',\n  openOnTriggerClick: true\n};\nPortal.autoControlledProps = ['open'];\nPortal._meta = {\n  name: 'Portal',\n  type: META.TYPES.ADDON\n};\nPortal.handledProps = ['children', 'className', 'closeOnDocumentClick', 'closeOnEscape', 'closeOnPortalMouseLeave', 'closeOnRootNodeClick', 'closeOnTriggerBlur', 'closeOnTriggerClick', 'closeOnTriggerMouseLeave', 'defaultOpen', 'eventPool', 'mountNode', 'mouseEnterDelay', 'mouseLeaveDelay', 'onClose', 'onMount', 'onOpen', 'onUnmount', 'open', 'openOnTriggerClick', 'openOnTriggerFocus', 'openOnTriggerMouseEnter', 'prepend', 'trigger'];\nPortal.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /** Primary content. */\n  children: PropTypes.node.isRequired,\n\n  /** Additional classes. */\n  className: PropTypes.string,\n\n  /** Controls whether or not the portal should close when the document is clicked. */\n  closeOnDocumentClick: PropTypes.bool,\n\n  /** Controls whether or not the portal should close when escape is pressed is displayed. */\n  closeOnEscape: PropTypes.bool,\n\n  /**\n   * Controls whether or not the portal should close when mousing out of the portal.\n   * NOTE: This will prevent `closeOnTriggerMouseLeave` when mousing over the\n   * gap from the trigger to the portal.\n   */\n  closeOnPortalMouseLeave: PropTypes.bool,\n\n  /**\n   * Controls whether or not the portal should close on a click on the portal background.\n   * NOTE: This differs from closeOnDocumentClick:\n   * - DocumentClick - any click not within the portal\n   * - RootNodeClick - a click not within the portal but within the portal's wrapper\n   */\n  closeOnRootNodeClick: PropTypes.bool,\n\n  /** Controls whether or not the portal should close on blur of the trigger. */\n  closeOnTriggerBlur: PropTypes.bool,\n\n  /** Controls whether or not the portal should close on click of the trigger. */\n  closeOnTriggerClick: PropTypes.bool,\n\n  /** Controls whether or not the portal should close when mousing out of the trigger. */\n  closeOnTriggerMouseLeave: PropTypes.bool,\n\n  /** Initial value of open. */\n  defaultOpen: PropTypes.bool,\n\n  /** Event pool namespace that is used to handle component events */\n  eventPool: PropTypes.string,\n\n  /** The node where the portal should mount. */\n  mountNode: PropTypes.any,\n\n  /** Milliseconds to wait before opening on mouse over */\n  mouseEnterDelay: PropTypes.number,\n\n  /** Milliseconds to wait before closing on mouse leave */\n  mouseLeaveDelay: PropTypes.number,\n\n  /**\n   * Called when a close event happens\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onClose: PropTypes.func,\n\n  /**\n   * Called when the portal is mounted on the DOM\n   *\n   * @param {null}\n   * @param {object} data - All props.\n   */\n  onMount: PropTypes.func,\n\n  /**\n   * Called when an open event happens\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onOpen: PropTypes.func,\n\n  /**\n   * Called when the portal is unmounted from the DOM\n   *\n   * @param {null}\n   * @param {object} data - All props.\n   */\n  onUnmount: PropTypes.func,\n\n  /** Controls whether or not the portal is displayed. */\n  open: PropTypes.bool,\n\n  /** Controls whether or not the portal should open when the trigger is clicked. */\n  openOnTriggerClick: PropTypes.bool,\n\n  /** Controls whether or not the portal should open on focus of the trigger. */\n  openOnTriggerFocus: PropTypes.bool,\n\n  /** Controls whether or not the portal should open when mousing over the trigger. */\n  openOnTriggerMouseEnter: PropTypes.bool,\n\n  /** Controls whether the portal should be prepended to the mountNode instead of appended. */\n  prepend: PropTypes.bool,\n\n  /** Element to be rendered in-place where the portal is defined. */\n  trigger: PropTypes.node\n} : {};\nexport default Portal;","map":{"version":3,"sources":["/Users/bly/Documents/工作/实验室/项目/医疗系统/PACS/pacs/node_modules/semantic-ui-react/dist/es/addons/Portal/Portal.js"],"names":["_extends","_classCallCheck","_createClass","_possibleConstructorReturn","_inherits","_invoke","PropTypes","React","Children","cloneElement","ReactDOM","AutoControlledComponent","Component","doesNodeContainClick","eventStack","isBrowser","keyboardKey","META","Ref","Portal","_Component","_ref","_temp","_this","_ret","_len","arguments","length","args","Array","_key","__proto__","Object","getPrototypeOf","call","apply","concat","handleDocumentClick","e","_this$props","props","closeOnDocumentClick","closeOnRootNodeClick","rootNode","portalNode","triggerNode","didClickInRootNode","close","handleEscape","closeOnEscape","getCode","Escape","handlePortalMouseLeave","_this$props2","closeOnPortalMouseLeave","mouseLeaveDelay","mouseLeaveTimer","closeWithTimeout","handlePortalMouseEnter","clearTimeout","handleTriggerBlur","_len2","rest","_key2","_this$props3","trigger","closeOnTriggerBlur","undefined","didFocusPortal","relatedTarget","handleTriggerClick","_len3","_key3","_this$props4","closeOnTriggerClick","openOnTriggerClick","open","state","handleTriggerFocus","_len4","_key4","_this$props5","openOnTriggerFocus","handleTriggerMouseLeave","_len5","_key5","mouseEnterTimer","_this$props6","closeOnTriggerMouseLeave","handleTriggerMouseEnter","_len6","_key6","_this$props7","mouseEnterDelay","openOnTriggerMouseEnter","openWithTimeout","onOpen","trySetState","delay","eventClone","setTimeout","onClose","attachRenderSubTreeSubscribers","eventPool","firstElementChild","sub","pool","target","mountPortal","_this$props8","_this$props8$mountNod","mountNode","document","body","prepend","createElement","insertBefore","appendChild","unmountPortal","unmountComponentAtNode","parentNode","removeChild","unsub","handleRef","c","key","value","componentDidMount","renderPortal","componentDidUpdate","prevProps","prevState","componentWillUnmount","_this2","_props","children","className","unstable_renderSubtreeIntoContainer","only","render","innerRef","onBlur","onClick","onFocus","onMouseLeave","onMouseEnter","defaultProps","autoControlledProps","_meta","name","type","TYPES","ADDON","handledProps","propTypes","process","env","NODE_ENV","node","isRequired","string","bool","defaultOpen","any","number","func","onMount","onUnmount"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport _invoke from 'lodash/invoke';\n\nimport PropTypes from 'prop-types';\nimport React, { Children, cloneElement } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { AutoControlledComponent as Component, doesNodeContainClick, eventStack, isBrowser, keyboardKey, META } from '../../lib';\nimport Ref from '../Ref';\n\n/**\n * A component that allows you to render children outside their parent.\n * @see Modal\n * @see Popup\n * @see Dimmer\n * @see Confirm\n */\nvar Portal = function (_Component) {\n  _inherits(Portal, _Component);\n\n  function Portal() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Portal);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Portal.__proto__ || Object.getPrototypeOf(Portal)).call.apply(_ref, [this].concat(args))), _this), _this.handleDocumentClick = function (e) {\n      var _this$props = _this.props,\n          closeOnDocumentClick = _this$props.closeOnDocumentClick,\n          closeOnRootNodeClick = _this$props.closeOnRootNodeClick;\n\n\n      if (!_this.rootNode // not mounted\n      || !_this.portalNode // no portal\n      || doesNodeContainClick(_this.triggerNode, e) // event happened in trigger (delegate to trigger handlers)\n      || doesNodeContainClick(_this.portalNode, e) // event happened in the portal\n      ) return; // ignore the click\n\n      var didClickInRootNode = doesNodeContainClick(_this.rootNode, e);\n\n      if (closeOnDocumentClick && !didClickInRootNode || closeOnRootNodeClick && didClickInRootNode) {\n\n        _this.close(e);\n      }\n    }, _this.handleEscape = function (e) {\n      if (!_this.props.closeOnEscape) return;\n      if (keyboardKey.getCode(e) !== keyboardKey.Escape) return;\n\n      _this.close(e);\n    }, _this.handlePortalMouseLeave = function (e) {\n      var _this$props2 = _this.props,\n          closeOnPortalMouseLeave = _this$props2.closeOnPortalMouseLeave,\n          mouseLeaveDelay = _this$props2.mouseLeaveDelay;\n\n\n      if (!closeOnPortalMouseLeave) return;\n\n      _this.mouseLeaveTimer = _this.closeWithTimeout(e, mouseLeaveDelay);\n    }, _this.handlePortalMouseEnter = function () {\n      // In order to enable mousing from the trigger to the portal, we need to\n      // clear the mouseleave timer that was set when leaving the trigger.\n      var closeOnPortalMouseLeave = _this.props.closeOnPortalMouseLeave;\n\n\n      if (!closeOnPortalMouseLeave) return;\n\n      clearTimeout(_this.mouseLeaveTimer);\n    }, _this.handleTriggerBlur = function (e) {\n      for (var _len2 = arguments.length, rest = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        rest[_key2 - 1] = arguments[_key2];\n      }\n\n      var _this$props3 = _this.props,\n          trigger = _this$props3.trigger,\n          closeOnTriggerBlur = _this$props3.closeOnTriggerBlur;\n\n      // Call original event handler\n\n      _invoke.apply(undefined, [trigger, 'props.onBlur', e].concat(rest));\n\n      // do not close if focus is given to the portal\n      var didFocusPortal = _invoke(_this, 'rootNode.contains', e.relatedTarget);\n\n      if (!closeOnTriggerBlur || didFocusPortal) return;\n\n      _this.close(e);\n    }, _this.handleTriggerClick = function (e) {\n      for (var _len3 = arguments.length, rest = Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        rest[_key3 - 1] = arguments[_key3];\n      }\n\n      var _this$props4 = _this.props,\n          trigger = _this$props4.trigger,\n          closeOnTriggerClick = _this$props4.closeOnTriggerClick,\n          openOnTriggerClick = _this$props4.openOnTriggerClick;\n      var open = _this.state.open;\n\n      // Call original event handler\n\n      _invoke.apply(undefined, [trigger, 'props.onClick', e].concat(rest));\n\n      if (open && closeOnTriggerClick) {\n\n        _this.close(e);\n      } else if (!open && openOnTriggerClick) {\n\n        _this.open(e);\n      }\n    }, _this.handleTriggerFocus = function (e) {\n      for (var _len4 = arguments.length, rest = Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        rest[_key4 - 1] = arguments[_key4];\n      }\n\n      var _this$props5 = _this.props,\n          trigger = _this$props5.trigger,\n          openOnTriggerFocus = _this$props5.openOnTriggerFocus;\n\n      // Call original event handler\n\n      _invoke.apply(undefined, [trigger, 'props.onFocus', e].concat(rest));\n\n      if (!openOnTriggerFocus) return;\n\n      _this.open(e);\n    }, _this.handleTriggerMouseLeave = function (e) {\n      for (var _len5 = arguments.length, rest = Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n        rest[_key5 - 1] = arguments[_key5];\n      }\n\n      clearTimeout(_this.mouseEnterTimer);\n\n      var _this$props6 = _this.props,\n          trigger = _this$props6.trigger,\n          closeOnTriggerMouseLeave = _this$props6.closeOnTriggerMouseLeave,\n          mouseLeaveDelay = _this$props6.mouseLeaveDelay;\n\n      // Call original event handler\n\n      _invoke.apply(undefined, [trigger, 'props.onMouseLeave', e].concat(rest));\n\n      if (!closeOnTriggerMouseLeave) return;\n\n      _this.mouseLeaveTimer = _this.closeWithTimeout(e, mouseLeaveDelay);\n    }, _this.handleTriggerMouseEnter = function (e) {\n      for (var _len6 = arguments.length, rest = Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {\n        rest[_key6 - 1] = arguments[_key6];\n      }\n\n      clearTimeout(_this.mouseLeaveTimer);\n\n      var _this$props7 = _this.props,\n          trigger = _this$props7.trigger,\n          mouseEnterDelay = _this$props7.mouseEnterDelay,\n          openOnTriggerMouseEnter = _this$props7.openOnTriggerMouseEnter;\n\n      // Call original event handler\n\n      _invoke.apply(undefined, [trigger, 'props.onMouseEnter', e].concat(rest));\n\n      if (!openOnTriggerMouseEnter) return;\n\n      _this.mouseEnterTimer = _this.openWithTimeout(e, mouseEnterDelay);\n    }, _this.open = function (e) {\n      var onOpen = _this.props.onOpen;\n\n      if (onOpen) onOpen(e, _this.props);\n\n      _this.trySetState({ open: true });\n    }, _this.openWithTimeout = function (e, delay) {\n      // React wipes the entire event object and suggests using e.persist() if\n      // you need the event for async access. However, even with e.persist\n      // certain required props (e.g. currentTarget) are null so we're forced to clone.\n      var eventClone = _extends({}, e);\n      return setTimeout(function () {\n        return _this.open(eventClone);\n      }, delay || 0);\n    }, _this.close = function (e) {\n      var onClose = _this.props.onClose;\n\n      if (onClose) onClose(e, _this.props);\n\n      _this.trySetState({ open: false });\n    }, _this.closeWithTimeout = function (e, delay) {\n      // React wipes the entire event object and suggests using e.persist() if\n      // you need the event for async access. However, even with e.persist\n      // certain required props (e.g. currentTarget) are null so we're forced to clone.\n      var eventClone = _extends({}, e);\n      return setTimeout(function () {\n        return _this.close(eventClone);\n      }, delay || 0);\n    }, _this.attachRenderSubTreeSubscribers = function (eventPool) {\n      // Prevent race condition bug\n      // https://github.com/Semantic-Org/Semantic-UI-React/issues/2401\n      if (!_this.rootNode) return null;\n\n      _this.portalNode = _this.rootNode.firstElementChild;\n\n      eventStack.sub('mouseleave', _this.handlePortalMouseLeave, { pool: eventPool, target: _this.portalNode });\n      eventStack.sub('mouseenter', _this.handlePortalMouseEnter, { pool: eventPool, target: _this.portalNode });\n    }, _this.mountPortal = function () {\n      if (!isBrowser() || _this.rootNode) return;\n\n      var _this$props8 = _this.props,\n          eventPool = _this$props8.eventPool,\n          _this$props8$mountNod = _this$props8.mountNode,\n          mountNode = _this$props8$mountNod === undefined ? isBrowser() ? document.body : null : _this$props8$mountNod,\n          prepend = _this$props8.prepend;\n\n\n      _this.rootNode = document.createElement('div');\n\n      if (prepend) {\n        mountNode.insertBefore(_this.rootNode, mountNode.firstElementChild);\n      } else {\n        mountNode.appendChild(_this.rootNode);\n      }\n\n      eventStack.sub('click', _this.handleDocumentClick, { pool: eventPool });\n      eventStack.sub('keydown', _this.handleEscape, { pool: eventPool });\n      _invoke(_this.props, 'onMount', null, _this.props);\n    }, _this.unmountPortal = function () {\n      if (!isBrowser() || !_this.rootNode) return;\n\n      var eventPool = _this.props.eventPool;\n\n\n      ReactDOM.unmountComponentAtNode(_this.rootNode);\n      _this.rootNode.parentNode.removeChild(_this.rootNode);\n\n      eventStack.unsub('mouseleave', _this.handlePortalMouseLeave, { pool: eventPool, target: _this.portalNode });\n      eventStack.unsub('mouseenter', _this.handlePortalMouseEnter, { pool: eventPool, target: _this.portalNode });\n\n      _this.rootNode = null;\n      _this.portalNode = null;\n\n      eventStack.unsub('click', _this.handleDocumentClick, { pool: eventPool });\n      eventStack.unsub('keydown', _this.handleEscape, { pool: eventPool });\n      _invoke(_this.props, 'onUnmount', null, _this.props);\n    }, _this.handleRef = function (c) {\n      return _this.triggerNode = c;\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Portal, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.renderPortal();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      // NOTE: Ideally the portal rendering would happen in the render() function\n      // but React gives a warning about not being pure and suggests doing it\n      // within this method.\n\n      // If the portal is open, render (or re-render) the portal and child.\n      this.renderPortal();\n\n      if (prevState.open && !this.state.open) {\n        this.unmountPortal();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unmountPortal();\n\n      // Clean up timers\n      clearTimeout(this.mouseEnterTimer);\n      clearTimeout(this.mouseLeaveTimer);\n    }\n\n    // ----------------------------------------\n    // Document Event Handlers\n    // ----------------------------------------\n\n    // ----------------------------------------\n    // Component Event Handlers\n    // ----------------------------------------\n\n    // ----------------------------------------\n    // Behavior\n    // ----------------------------------------\n\n  }, {\n    key: 'renderPortal',\n    value: function renderPortal() {\n      var _this2 = this;\n\n      if (!this.state.open) return;\n      var _props = this.props,\n          children = _props.children,\n          className = _props.className,\n          eventPool = _props.eventPool;\n\n\n      this.mountPortal();\n\n      // Server side rendering\n      if (!isBrowser()) return null;\n\n      this.rootNode.className = className || '';\n\n      // when re-rendering, first remove listeners before re-adding them to the new node\n      if (this.portalNode) {\n        eventStack.unsub('mouseleave', this.handlePortalMouseLeave, { pool: eventPool, target: this.portalNode });\n        eventStack.unsub('mouseenter', this.handlePortalMouseEnter, { pool: eventPool, target: this.portalNode });\n      }\n\n      ReactDOM.unstable_renderSubtreeIntoContainer(this, Children.only(children), this.rootNode, function () {\n        return _this2.attachRenderSubTreeSubscribers(eventPool);\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var trigger = this.props.trigger;\n\n\n      if (!trigger) return null;\n      return React.createElement(\n        Ref,\n        { innerRef: this.handleRef },\n        cloneElement(trigger, {\n          onBlur: this.handleTriggerBlur,\n          onClick: this.handleTriggerClick,\n          onFocus: this.handleTriggerFocus,\n          onMouseLeave: this.handleTriggerMouseLeave,\n          onMouseEnter: this.handleTriggerMouseEnter\n        })\n      );\n    }\n  }]);\n\n  return Portal;\n}(Component);\n\nPortal.defaultProps = {\n  closeOnDocumentClick: true,\n  closeOnEscape: true,\n  eventPool: 'default',\n  openOnTriggerClick: true\n};\nPortal.autoControlledProps = ['open'];\nPortal._meta = {\n  name: 'Portal',\n  type: META.TYPES.ADDON\n};\nPortal.handledProps = ['children', 'className', 'closeOnDocumentClick', 'closeOnEscape', 'closeOnPortalMouseLeave', 'closeOnRootNodeClick', 'closeOnTriggerBlur', 'closeOnTriggerClick', 'closeOnTriggerMouseLeave', 'defaultOpen', 'eventPool', 'mountNode', 'mouseEnterDelay', 'mouseLeaveDelay', 'onClose', 'onMount', 'onOpen', 'onUnmount', 'open', 'openOnTriggerClick', 'openOnTriggerFocus', 'openOnTriggerMouseEnter', 'prepend', 'trigger'];\nPortal.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /** Primary content. */\n  children: PropTypes.node.isRequired,\n\n  /** Additional classes. */\n  className: PropTypes.string,\n\n  /** Controls whether or not the portal should close when the document is clicked. */\n  closeOnDocumentClick: PropTypes.bool,\n\n  /** Controls whether or not the portal should close when escape is pressed is displayed. */\n  closeOnEscape: PropTypes.bool,\n\n  /**\n   * Controls whether or not the portal should close when mousing out of the portal.\n   * NOTE: This will prevent `closeOnTriggerMouseLeave` when mousing over the\n   * gap from the trigger to the portal.\n   */\n  closeOnPortalMouseLeave: PropTypes.bool,\n\n  /**\n   * Controls whether or not the portal should close on a click on the portal background.\n   * NOTE: This differs from closeOnDocumentClick:\n   * - DocumentClick - any click not within the portal\n   * - RootNodeClick - a click not within the portal but within the portal's wrapper\n   */\n  closeOnRootNodeClick: PropTypes.bool,\n\n  /** Controls whether or not the portal should close on blur of the trigger. */\n  closeOnTriggerBlur: PropTypes.bool,\n\n  /** Controls whether or not the portal should close on click of the trigger. */\n  closeOnTriggerClick: PropTypes.bool,\n\n  /** Controls whether or not the portal should close when mousing out of the trigger. */\n  closeOnTriggerMouseLeave: PropTypes.bool,\n\n  /** Initial value of open. */\n  defaultOpen: PropTypes.bool,\n\n  /** Event pool namespace that is used to handle component events */\n  eventPool: PropTypes.string,\n\n  /** The node where the portal should mount. */\n  mountNode: PropTypes.any,\n\n  /** Milliseconds to wait before opening on mouse over */\n  mouseEnterDelay: PropTypes.number,\n\n  /** Milliseconds to wait before closing on mouse leave */\n  mouseLeaveDelay: PropTypes.number,\n\n  /**\n   * Called when a close event happens\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onClose: PropTypes.func,\n\n  /**\n   * Called when the portal is mounted on the DOM\n   *\n   * @param {null}\n   * @param {object} data - All props.\n   */\n  onMount: PropTypes.func,\n\n  /**\n   * Called when an open event happens\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onOpen: PropTypes.func,\n\n  /**\n   * Called when the portal is unmounted from the DOM\n   *\n   * @param {null}\n   * @param {object} data - All props.\n   */\n  onUnmount: PropTypes.func,\n\n  /** Controls whether or not the portal is displayed. */\n  open: PropTypes.bool,\n\n  /** Controls whether or not the portal should open when the trigger is clicked. */\n  openOnTriggerClick: PropTypes.bool,\n\n  /** Controls whether or not the portal should open on focus of the trigger. */\n  openOnTriggerFocus: PropTypes.bool,\n\n  /** Controls whether or not the portal should open when mousing over the trigger. */\n  openOnTriggerMouseEnter: PropTypes.bool,\n\n  /** Controls whether the portal should be prepended to the mountNode instead of appended. */\n  prepend: PropTypes.bool,\n\n  /** Element to be rendered in-place where the portal is defined. */\n  trigger: PropTypes.node\n} : {};\n\n\nexport default Portal;"]},"metadata":{},"sourceType":"module"}