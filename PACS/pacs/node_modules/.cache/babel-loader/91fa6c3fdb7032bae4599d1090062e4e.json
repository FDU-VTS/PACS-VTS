{"ast":null,"code":"function _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport CaretDownOutlined from '@ant-design/icons/CaretDownOutlined';\nimport CaretUpOutlined from '@ant-design/icons/CaretUpOutlined';\nimport Tooltip from '../../tooltip';\nimport { getColumnKey, getColumnPos, renderColumnTitle } from '../util';\nvar ASCEND = 'ascend';\nvar DESCEND = 'descend';\n\nfunction getMultiplePriority(column) {\n  if (_typeof(column.sorter) === 'object' && typeof column.sorter.multiple === 'number') {\n    return column.sorter.multiple;\n  }\n\n  return false;\n}\n\nfunction getSortFunction(sorter) {\n  if (typeof sorter === 'function') {\n    return sorter;\n  }\n\n  if (sorter && _typeof(sorter) === 'object' && sorter.compare) {\n    return sorter.compare;\n  }\n\n  return false;\n}\n\nfunction nextSortDirection(sortDirections, current) {\n  if (!current) {\n    return sortDirections[0];\n  }\n\n  return sortDirections[sortDirections.indexOf(current) + 1];\n}\n\nfunction collectSortStates(columns, init, pos) {\n  var sortStates = [];\n\n  function pushState(column, columnPos) {\n    sortStates.push({\n      column: column,\n      key: getColumnKey(column, columnPos),\n      multiplePriority: getMultiplePriority(column),\n      sortOrder: column.sortOrder\n    });\n  }\n\n  (columns || []).forEach(function (column, index) {\n    var columnPos = getColumnPos(index, pos);\n\n    if (column.children) {\n      if ('sortOrder' in column) {\n        // Controlled\n        pushState(column, columnPos);\n      }\n\n      sortStates = [].concat(_toConsumableArray(sortStates), _toConsumableArray(collectSortStates(column.children, init, columnPos)));\n    } else if (column.sorter) {\n      if ('sortOrder' in column) {\n        // Controlled\n        pushState(column, columnPos);\n      } else if (init && column.defaultSortOrder) {\n        // Default sorter\n        sortStates.push({\n          column: column,\n          key: getColumnKey(column, columnPos),\n          multiplePriority: getMultiplePriority(column),\n          sortOrder: column.defaultSortOrder\n        });\n      }\n    }\n  });\n  return sortStates;\n}\n\nfunction injectSorter(prefixCls, columns, sorterSates, triggerSorter, defaultSortDirections, tableLocale, tableShowSorterTooltip, pos) {\n  return (columns || []).map(function (column, index) {\n    var columnPos = getColumnPos(index, pos);\n    var newColumn = column;\n\n    if (newColumn.sorter) {\n      var sortDirections = newColumn.sortDirections || defaultSortDirections;\n      var showSorterTooltip = newColumn.showSorterTooltip === undefined ? tableShowSorterTooltip : newColumn.showSorterTooltip;\n      var columnKey = getColumnKey(newColumn, columnPos);\n      var sorterState = sorterSates.find(function (_ref) {\n        var key = _ref.key;\n        return key === columnKey;\n      });\n      var sorterOrder = sorterState ? sorterState.sortOrder : null;\n      var nextSortOrder = nextSortDirection(sortDirections, sorterOrder);\n      var upNode = sortDirections.includes(ASCEND) && /*#__PURE__*/React.createElement(CaretUpOutlined, {\n        className: classNames(\"\".concat(prefixCls, \"-column-sorter-up\"), {\n          active: sorterOrder === ASCEND\n        })\n      });\n      var downNode = sortDirections.includes(DESCEND) && /*#__PURE__*/React.createElement(CaretDownOutlined, {\n        className: classNames(\"\".concat(prefixCls, \"-column-sorter-down\"), {\n          active: sorterOrder === DESCEND\n        })\n      });\n\n      var _ref2 = tableLocale || {},\n          cancelSort = _ref2.cancelSort,\n          triggerAsc = _ref2.triggerAsc,\n          triggerDesc = _ref2.triggerDesc;\n\n      var sortTip = cancelSort;\n\n      if (nextSortOrder === DESCEND) {\n        sortTip = triggerDesc;\n      } else if (nextSortOrder === ASCEND) {\n        sortTip = triggerAsc;\n      }\n\n      newColumn = _extends(_extends({}, newColumn), {\n        className: classNames(newColumn.className, _defineProperty({}, \"\".concat(prefixCls, \"-column-sort\"), sorterOrder)),\n        title: function title(renderProps) {\n          var renderSortTitle = /*#__PURE__*/React.createElement(\"div\", {\n            className: \"\".concat(prefixCls, \"-column-sorters\")\n          }, /*#__PURE__*/React.createElement(\"span\", null, renderColumnTitle(column.title, renderProps)), /*#__PURE__*/React.createElement(\"span\", {\n            className: classNames(\"\".concat(prefixCls, \"-column-sorter\"), _defineProperty({}, \"\".concat(prefixCls, \"-column-sorter-full\"), upNode && downNode))\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"\".concat(prefixCls, \"-column-sorter-inner\")\n          }, upNode, downNode)));\n          return showSorterTooltip ? /*#__PURE__*/React.createElement(Tooltip, {\n            title: sortTip\n          }, /*#__PURE__*/React.createElement(\"div\", {\n            className: \"\".concat(prefixCls, \"-column-sorters-with-tooltip\")\n          }, renderSortTitle)) : renderSortTitle;\n        },\n        onHeaderCell: function onHeaderCell(col) {\n          var cell = column.onHeaderCell && column.onHeaderCell(col) || {};\n          var originOnClick = cell.onClick;\n\n          cell.onClick = function (event) {\n            triggerSorter({\n              column: column,\n              key: columnKey,\n              sortOrder: nextSortOrder,\n              multiplePriority: getMultiplePriority(column)\n            });\n\n            if (originOnClick) {\n              originOnClick(event);\n            }\n          };\n\n          cell.className = classNames(cell.className, \"\".concat(prefixCls, \"-column-has-sorters\"));\n          return cell;\n        }\n      });\n    }\n\n    if ('children' in newColumn) {\n      newColumn = _extends(_extends({}, newColumn), {\n        children: injectSorter(prefixCls, newColumn.children, sorterSates, triggerSorter, defaultSortDirections, tableLocale, tableShowSorterTooltip, columnPos)\n      });\n    }\n\n    return newColumn;\n  });\n}\n\nfunction stateToInfo(sorterStates) {\n  var column = sorterStates.column,\n      sortOrder = sorterStates.sortOrder;\n  return {\n    column: column,\n    order: sortOrder,\n    field: column.dataIndex,\n    columnKey: column.key\n  };\n}\n\nfunction generateSorterInfo(sorterStates) {\n  var list = sorterStates.filter(function (_ref3) {\n    var sortOrder = _ref3.sortOrder;\n    return sortOrder;\n  }).map(stateToInfo); // =========== Legacy compatible support ===========\n  // https://github.com/ant-design/ant-design/pull/19226\n\n  if (list.length === 0 && sorterStates.length) {\n    return _extends(_extends({}, stateToInfo(sorterStates[0])), {\n      column: undefined\n    });\n  }\n\n  if (list.length <= 1) {\n    return list[0] || {};\n  }\n\n  return list;\n}\n\nexport function getSortData(data, sortStates, childrenColumnName) {\n  var innerSorterStates = sortStates.slice().sort(function (a, b) {\n    return b.multiplePriority - a.multiplePriority;\n  });\n  var cloneData = data.slice();\n  var runningSorters = innerSorterStates.filter(function (_ref4) {\n    var sorter = _ref4.column.sorter,\n        sortOrder = _ref4.sortOrder;\n    return getSortFunction(sorter) && sortOrder;\n  }); // Skip if no sorter needed\n\n  if (!runningSorters.length) {\n    return cloneData;\n  }\n\n  return cloneData.sort(function (record1, record2) {\n    for (var i = 0; i < runningSorters.length; i += 1) {\n      var sorterState = runningSorters[i];\n      var sorter = sorterState.column.sorter,\n          sortOrder = sorterState.sortOrder;\n      var compareFn = getSortFunction(sorter);\n\n      if (compareFn && sortOrder) {\n        var compareResult = compareFn(record1, record2, sortOrder);\n\n        if (compareResult !== 0) {\n          return sortOrder === ASCEND ? compareResult : -compareResult;\n        }\n      }\n    }\n\n    return 0;\n  }).map(function (record) {\n    var subRecords = record[childrenColumnName];\n\n    if (subRecords) {\n      return _extends(_extends({}, record), _defineProperty({}, childrenColumnName, getSortData(subRecords, sortStates, childrenColumnName)));\n    }\n\n    return record;\n  });\n}\nexport default function useFilterSorter(_ref5) {\n  var prefixCls = _ref5.prefixCls,\n      mergedColumns = _ref5.mergedColumns,\n      onSorterChange = _ref5.onSorterChange,\n      sortDirections = _ref5.sortDirections,\n      tableLocale = _ref5.tableLocale,\n      showSorterTooltip = _ref5.showSorterTooltip;\n\n  var _React$useState = React.useState(collectSortStates(mergedColumns, true)),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      sortStates = _React$useState2[0],\n      setSortStates = _React$useState2[1];\n\n  var mergedSorterStates = React.useMemo(function () {\n    var validate = true;\n    var collectedStates = collectSortStates(mergedColumns, false); // Return if not controlled\n\n    if (!collectedStates.length) {\n      return sortStates;\n    }\n\n    var validateStates = [];\n\n    function patchStates(state) {\n      if (validate) {\n        validateStates.push(state);\n      } else {\n        validateStates.push(_extends(_extends({}, state), {\n          sortOrder: null\n        }));\n      }\n    }\n\n    var multipleMode = null;\n    collectedStates.forEach(function (state) {\n      if (multipleMode === null) {\n        patchStates(state);\n\n        if (state.sortOrder) {\n          if (state.multiplePriority === false) {\n            validate = false;\n          } else {\n            multipleMode = true;\n          }\n        }\n      } else if (multipleMode && state.multiplePriority !== false) {\n        patchStates(state);\n      } else {\n        validate = false;\n        patchStates(state);\n      }\n    });\n    return validateStates;\n  }, [mergedColumns, sortStates]); // Get render columns title required props\n\n  var columnTitleSorterProps = React.useMemo(function () {\n    var sortColumns = mergedSorterStates.map(function (_ref6) {\n      var column = _ref6.column,\n          sortOrder = _ref6.sortOrder;\n      return {\n        column: column,\n        order: sortOrder\n      };\n    });\n    return {\n      sortColumns: sortColumns,\n      // Legacy\n      sortColumn: sortColumns[0] && sortColumns[0].column,\n      sortOrder: sortColumns[0] && sortColumns[0].order\n    };\n  }, [mergedSorterStates]);\n\n  function triggerSorter(sortState) {\n    var newSorterStates;\n\n    if (sortState.multiplePriority === false || !mergedSorterStates.length || mergedSorterStates[0].multiplePriority === false) {\n      newSorterStates = [sortState];\n    } else {\n      newSorterStates = [].concat(_toConsumableArray(mergedSorterStates.filter(function (_ref7) {\n        var key = _ref7.key;\n        return key !== sortState.key;\n      })), [sortState]);\n    }\n\n    setSortStates(newSorterStates);\n    onSorterChange(generateSorterInfo(newSorterStates), newSorterStates);\n  }\n\n  var transformColumns = function transformColumns(innerColumns) {\n    return injectSorter(prefixCls, innerColumns, mergedSorterStates, triggerSorter, sortDirections, tableLocale, showSorterTooltip);\n  };\n\n  var getSorters = function getSorters() {\n    return generateSorterInfo(mergedSorterStates);\n  };\n\n  return [transformColumns, mergedSorterStates, columnTitleSorterProps, getSorters];\n}","map":{"version":3,"sources":["/Users/bly/Documents/工作/实验室/项目/医疗系统/PACS-VTS/PACS-VTS/PACS/pacs/node_modules/antd/es/table/hooks/useSorter.js"],"names":["_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","Symbol","iterator","Object","_arr","_n","_d","_e","undefined","_i","_s","next","done","push","value","length","err","Array","isArray","_defineProperty","obj","key","defineProperty","enumerable","configurable","writable","_extends","assign","target","arguments","source","prototype","hasOwnProperty","call","apply","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","o","minLen","_arrayLikeToArray","n","toString","slice","constructor","name","from","test","iter","len","arr2","_typeof","React","classNames","CaretDownOutlined","CaretUpOutlined","Tooltip","getColumnKey","getColumnPos","renderColumnTitle","ASCEND","DESCEND","getMultiplePriority","column","sorter","multiple","getSortFunction","compare","nextSortDirection","sortDirections","current","indexOf","collectSortStates","columns","init","pos","sortStates","pushState","columnPos","multiplePriority","sortOrder","forEach","index","children","concat","defaultSortOrder","injectSorter","prefixCls","sorterSates","triggerSorter","defaultSortDirections","tableLocale","tableShowSorterTooltip","map","newColumn","showSorterTooltip","columnKey","sorterState","find","_ref","sorterOrder","nextSortOrder","upNode","includes","createElement","className","active","downNode","_ref2","cancelSort","triggerAsc","triggerDesc","sortTip","title","renderProps","renderSortTitle","onHeaderCell","col","cell","originOnClick","onClick","event","stateToInfo","sorterStates","order","field","dataIndex","generateSorterInfo","list","filter","_ref3","getSortData","data","childrenColumnName","innerSorterStates","sort","a","b","cloneData","runningSorters","_ref4","record1","record2","compareFn","compareResult","record","subRecords","useFilterSorter","_ref5","mergedColumns","onSorterChange","_React$useState","useState","_React$useState2","setSortStates","mergedSorterStates","useMemo","validate","collectedStates","validateStates","patchStates","state","multipleMode","columnTitleSorterProps","sortColumns","_ref6","sortColumn","sortState","newSorterStates","_ref7","transformColumns","innerColumns","getSorters"],"mappings":"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","sourcesContent":["function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport CaretDownOutlined from '@ant-design/icons/CaretDownOutlined';\nimport CaretUpOutlined from '@ant-design/icons/CaretUpOutlined';\nimport Tooltip from '../../tooltip';\nimport { getColumnKey, getColumnPos, renderColumnTitle } from '../util';\nvar ASCEND = 'ascend';\nvar DESCEND = 'descend';\n\nfunction getMultiplePriority(column) {\n  if (_typeof(column.sorter) === 'object' && typeof column.sorter.multiple === 'number') {\n    return column.sorter.multiple;\n  }\n\n  return false;\n}\n\nfunction getSortFunction(sorter) {\n  if (typeof sorter === 'function') {\n    return sorter;\n  }\n\n  if (sorter && _typeof(sorter) === 'object' && sorter.compare) {\n    return sorter.compare;\n  }\n\n  return false;\n}\n\nfunction nextSortDirection(sortDirections, current) {\n  if (!current) {\n    return sortDirections[0];\n  }\n\n  return sortDirections[sortDirections.indexOf(current) + 1];\n}\n\nfunction collectSortStates(columns, init, pos) {\n  var sortStates = [];\n\n  function pushState(column, columnPos) {\n    sortStates.push({\n      column: column,\n      key: getColumnKey(column, columnPos),\n      multiplePriority: getMultiplePriority(column),\n      sortOrder: column.sortOrder\n    });\n  }\n\n  (columns || []).forEach(function (column, index) {\n    var columnPos = getColumnPos(index, pos);\n\n    if (column.children) {\n      if ('sortOrder' in column) {\n        // Controlled\n        pushState(column, columnPos);\n      }\n\n      sortStates = [].concat(_toConsumableArray(sortStates), _toConsumableArray(collectSortStates(column.children, init, columnPos)));\n    } else if (column.sorter) {\n      if ('sortOrder' in column) {\n        // Controlled\n        pushState(column, columnPos);\n      } else if (init && column.defaultSortOrder) {\n        // Default sorter\n        sortStates.push({\n          column: column,\n          key: getColumnKey(column, columnPos),\n          multiplePriority: getMultiplePriority(column),\n          sortOrder: column.defaultSortOrder\n        });\n      }\n    }\n  });\n  return sortStates;\n}\n\nfunction injectSorter(prefixCls, columns, sorterSates, triggerSorter, defaultSortDirections, tableLocale, tableShowSorterTooltip, pos) {\n  return (columns || []).map(function (column, index) {\n    var columnPos = getColumnPos(index, pos);\n    var newColumn = column;\n\n    if (newColumn.sorter) {\n      var sortDirections = newColumn.sortDirections || defaultSortDirections;\n      var showSorterTooltip = newColumn.showSorterTooltip === undefined ? tableShowSorterTooltip : newColumn.showSorterTooltip;\n      var columnKey = getColumnKey(newColumn, columnPos);\n      var sorterState = sorterSates.find(function (_ref) {\n        var key = _ref.key;\n        return key === columnKey;\n      });\n      var sorterOrder = sorterState ? sorterState.sortOrder : null;\n      var nextSortOrder = nextSortDirection(sortDirections, sorterOrder);\n      var upNode = sortDirections.includes(ASCEND) && /*#__PURE__*/React.createElement(CaretUpOutlined, {\n        className: classNames(\"\".concat(prefixCls, \"-column-sorter-up\"), {\n          active: sorterOrder === ASCEND\n        })\n      });\n      var downNode = sortDirections.includes(DESCEND) && /*#__PURE__*/React.createElement(CaretDownOutlined, {\n        className: classNames(\"\".concat(prefixCls, \"-column-sorter-down\"), {\n          active: sorterOrder === DESCEND\n        })\n      });\n\n      var _ref2 = tableLocale || {},\n          cancelSort = _ref2.cancelSort,\n          triggerAsc = _ref2.triggerAsc,\n          triggerDesc = _ref2.triggerDesc;\n\n      var sortTip = cancelSort;\n\n      if (nextSortOrder === DESCEND) {\n        sortTip = triggerDesc;\n      } else if (nextSortOrder === ASCEND) {\n        sortTip = triggerAsc;\n      }\n\n      newColumn = _extends(_extends({}, newColumn), {\n        className: classNames(newColumn.className, _defineProperty({}, \"\".concat(prefixCls, \"-column-sort\"), sorterOrder)),\n        title: function title(renderProps) {\n          var renderSortTitle = /*#__PURE__*/React.createElement(\"div\", {\n            className: \"\".concat(prefixCls, \"-column-sorters\")\n          }, /*#__PURE__*/React.createElement(\"span\", null, renderColumnTitle(column.title, renderProps)), /*#__PURE__*/React.createElement(\"span\", {\n            className: classNames(\"\".concat(prefixCls, \"-column-sorter\"), _defineProperty({}, \"\".concat(prefixCls, \"-column-sorter-full\"), upNode && downNode))\n          }, /*#__PURE__*/React.createElement(\"span\", {\n            className: \"\".concat(prefixCls, \"-column-sorter-inner\")\n          }, upNode, downNode)));\n          return showSorterTooltip ? /*#__PURE__*/React.createElement(Tooltip, {\n            title: sortTip\n          }, /*#__PURE__*/React.createElement(\"div\", {\n            className: \"\".concat(prefixCls, \"-column-sorters-with-tooltip\")\n          }, renderSortTitle)) : renderSortTitle;\n        },\n        onHeaderCell: function onHeaderCell(col) {\n          var cell = column.onHeaderCell && column.onHeaderCell(col) || {};\n          var originOnClick = cell.onClick;\n\n          cell.onClick = function (event) {\n            triggerSorter({\n              column: column,\n              key: columnKey,\n              sortOrder: nextSortOrder,\n              multiplePriority: getMultiplePriority(column)\n            });\n\n            if (originOnClick) {\n              originOnClick(event);\n            }\n          };\n\n          cell.className = classNames(cell.className, \"\".concat(prefixCls, \"-column-has-sorters\"));\n          return cell;\n        }\n      });\n    }\n\n    if ('children' in newColumn) {\n      newColumn = _extends(_extends({}, newColumn), {\n        children: injectSorter(prefixCls, newColumn.children, sorterSates, triggerSorter, defaultSortDirections, tableLocale, tableShowSorterTooltip, columnPos)\n      });\n    }\n\n    return newColumn;\n  });\n}\n\nfunction stateToInfo(sorterStates) {\n  var column = sorterStates.column,\n      sortOrder = sorterStates.sortOrder;\n  return {\n    column: column,\n    order: sortOrder,\n    field: column.dataIndex,\n    columnKey: column.key\n  };\n}\n\nfunction generateSorterInfo(sorterStates) {\n  var list = sorterStates.filter(function (_ref3) {\n    var sortOrder = _ref3.sortOrder;\n    return sortOrder;\n  }).map(stateToInfo); // =========== Legacy compatible support ===========\n  // https://github.com/ant-design/ant-design/pull/19226\n\n  if (list.length === 0 && sorterStates.length) {\n    return _extends(_extends({}, stateToInfo(sorterStates[0])), {\n      column: undefined\n    });\n  }\n\n  if (list.length <= 1) {\n    return list[0] || {};\n  }\n\n  return list;\n}\n\nexport function getSortData(data, sortStates, childrenColumnName) {\n  var innerSorterStates = sortStates.slice().sort(function (a, b) {\n    return b.multiplePriority - a.multiplePriority;\n  });\n  var cloneData = data.slice();\n  var runningSorters = innerSorterStates.filter(function (_ref4) {\n    var sorter = _ref4.column.sorter,\n        sortOrder = _ref4.sortOrder;\n    return getSortFunction(sorter) && sortOrder;\n  }); // Skip if no sorter needed\n\n  if (!runningSorters.length) {\n    return cloneData;\n  }\n\n  return cloneData.sort(function (record1, record2) {\n    for (var i = 0; i < runningSorters.length; i += 1) {\n      var sorterState = runningSorters[i];\n      var sorter = sorterState.column.sorter,\n          sortOrder = sorterState.sortOrder;\n      var compareFn = getSortFunction(sorter);\n\n      if (compareFn && sortOrder) {\n        var compareResult = compareFn(record1, record2, sortOrder);\n\n        if (compareResult !== 0) {\n          return sortOrder === ASCEND ? compareResult : -compareResult;\n        }\n      }\n    }\n\n    return 0;\n  }).map(function (record) {\n    var subRecords = record[childrenColumnName];\n\n    if (subRecords) {\n      return _extends(_extends({}, record), _defineProperty({}, childrenColumnName, getSortData(subRecords, sortStates, childrenColumnName)));\n    }\n\n    return record;\n  });\n}\nexport default function useFilterSorter(_ref5) {\n  var prefixCls = _ref5.prefixCls,\n      mergedColumns = _ref5.mergedColumns,\n      onSorterChange = _ref5.onSorterChange,\n      sortDirections = _ref5.sortDirections,\n      tableLocale = _ref5.tableLocale,\n      showSorterTooltip = _ref5.showSorterTooltip;\n\n  var _React$useState = React.useState(collectSortStates(mergedColumns, true)),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      sortStates = _React$useState2[0],\n      setSortStates = _React$useState2[1];\n\n  var mergedSorterStates = React.useMemo(function () {\n    var validate = true;\n    var collectedStates = collectSortStates(mergedColumns, false); // Return if not controlled\n\n    if (!collectedStates.length) {\n      return sortStates;\n    }\n\n    var validateStates = [];\n\n    function patchStates(state) {\n      if (validate) {\n        validateStates.push(state);\n      } else {\n        validateStates.push(_extends(_extends({}, state), {\n          sortOrder: null\n        }));\n      }\n    }\n\n    var multipleMode = null;\n    collectedStates.forEach(function (state) {\n      if (multipleMode === null) {\n        patchStates(state);\n\n        if (state.sortOrder) {\n          if (state.multiplePriority === false) {\n            validate = false;\n          } else {\n            multipleMode = true;\n          }\n        }\n      } else if (multipleMode && state.multiplePriority !== false) {\n        patchStates(state);\n      } else {\n        validate = false;\n        patchStates(state);\n      }\n    });\n    return validateStates;\n  }, [mergedColumns, sortStates]); // Get render columns title required props\n\n  var columnTitleSorterProps = React.useMemo(function () {\n    var sortColumns = mergedSorterStates.map(function (_ref6) {\n      var column = _ref6.column,\n          sortOrder = _ref6.sortOrder;\n      return {\n        column: column,\n        order: sortOrder\n      };\n    });\n    return {\n      sortColumns: sortColumns,\n      // Legacy\n      sortColumn: sortColumns[0] && sortColumns[0].column,\n      sortOrder: sortColumns[0] && sortColumns[0].order\n    };\n  }, [mergedSorterStates]);\n\n  function triggerSorter(sortState) {\n    var newSorterStates;\n\n    if (sortState.multiplePriority === false || !mergedSorterStates.length || mergedSorterStates[0].multiplePriority === false) {\n      newSorterStates = [sortState];\n    } else {\n      newSorterStates = [].concat(_toConsumableArray(mergedSorterStates.filter(function (_ref7) {\n        var key = _ref7.key;\n        return key !== sortState.key;\n      })), [sortState]);\n    }\n\n    setSortStates(newSorterStates);\n    onSorterChange(generateSorterInfo(newSorterStates), newSorterStates);\n  }\n\n  var transformColumns = function transformColumns(innerColumns) {\n    return injectSorter(prefixCls, innerColumns, mergedSorterStates, triggerSorter, sortDirections, tableLocale, showSorterTooltip);\n  };\n\n  var getSorters = function getSorters() {\n    return generateSorterInfo(mergedSorterStates);\n  };\n\n  return [transformColumns, mergedSorterStates, columnTitleSorterProps, getSorters];\n}"]},"metadata":{},"sourceType":"module"}