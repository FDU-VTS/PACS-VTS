{"ast":null,"code":"import _slicedToArray from 'babel-runtime/helpers/slicedToArray';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _get2 from 'babel-runtime/helpers/get';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport _isEmpty from 'lodash/isEmpty';\nimport _partialRight from 'lodash/partialRight';\nimport _inRange from 'lodash/inRange';\nimport _map from 'lodash/map';\nimport _get from 'lodash/get';\nimport _reduce from 'lodash/reduce';\nimport _invoke from 'lodash/invoke';\nimport _without from 'lodash/without';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { AutoControlledComponent as Component, customPropTypes, eventStack, getElementType, getUnhandledProps, htmlInputAttrs, isBrowser, keyboardKey, META, objectDiff, partitionHTMLProps, shallowEqual, SUI, useKeyOnly, useValueAndKey } from '../../lib';\nimport Input from '../../elements/Input';\nimport SearchCategory from './SearchCategory';\nimport SearchResult from './SearchResult';\nimport SearchResults from './SearchResults';\n/**\n * A search module allows a user to query for results from a selection of data\n */\n\nvar Search = function (_Component) {\n  _inherits(Search, _Component);\n\n  function Search() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Search);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Search.__proto__ || Object.getPrototypeOf(Search)).call.apply(_ref, [this].concat(args))), _this), _this.handleResultSelect = function (e, result) {\n      _invoke(_this.props, 'onResultSelect', e, _extends({}, _this.props, {\n        result: result\n      }));\n    }, _this.handleSelectionChange = function (e) {\n      var result = _this.getSelectedResult();\n\n      _invoke(_this.props, 'onSelectionChange', e, _extends({}, _this.props, {\n        result: result\n      }));\n    }, _this.closeOnEscape = function (e) {\n      if (keyboardKey.getCode(e) !== keyboardKey.Escape) return;\n      e.preventDefault();\n\n      _this.close();\n    }, _this.moveSelectionOnKeyDown = function (e) {\n      switch (keyboardKey.getCode(e)) {\n        case keyboardKey.ArrowDown:\n          e.preventDefault();\n\n          _this.moveSelectionBy(e, 1);\n\n          break;\n\n        case keyboardKey.ArrowUp:\n          e.preventDefault();\n\n          _this.moveSelectionBy(e, -1);\n\n          break;\n\n        default:\n          break;\n      }\n    }, _this.selectItemOnEnter = function (e) {\n      if (keyboardKey.getCode(e) !== keyboardKey.Enter) return;\n\n      var result = _this.getSelectedResult(); // prevent selecting null if there was no selected item value\n\n\n      if (!result) return;\n      e.preventDefault(); // notify the onResultSelect prop that the user is trying to change value\n\n      _this.setValue(result.title);\n\n      _this.handleResultSelect(e, result);\n\n      _this.close();\n    }, _this.closeOnDocumentClick = function (e) {\n      _this.close();\n    }, _this.handleMouseDown = function (e) {\n      _this.isMouseDown = true;\n\n      _invoke(_this.props, 'onMouseDown', e, _this.props);\n\n      eventStack.sub('mouseup', _this.handleDocumentMouseUp);\n    }, _this.handleDocumentMouseUp = function () {\n      _this.isMouseDown = false;\n      eventStack.unsub('mouseup', _this.handleDocumentMouseUp);\n    }, _this.handleInputClick = function (e) {\n      // prevent closeOnDocumentClick()\n      e.nativeEvent.stopImmediatePropagation();\n\n      _this.tryOpen();\n    }, _this.handleItemClick = function (e, _ref2) {\n      var id = _ref2.id;\n\n      var result = _this.getSelectedResult(id); // prevent closeOnDocumentClick()\n\n\n      e.nativeEvent.stopImmediatePropagation(); // notify the onResultSelect prop that the user is trying to change value\n\n      _this.setValue(result.title);\n\n      _this.handleResultSelect(e, result);\n\n      _this.close();\n    }, _this.handleFocus = function (e) {\n      var onFocus = _this.props.onFocus;\n      if (onFocus) onFocus(e, _this.props);\n\n      _this.setState({\n        focus: true\n      });\n    }, _this.handleBlur = function (e) {\n      var onBlur = _this.props.onBlur;\n      if (onBlur) onBlur(e, _this.props);\n\n      _this.setState({\n        focus: false\n      });\n    }, _this.handleSearchChange = function (e) {\n      // prevent propagating to this.props.onChange()\n      e.stopPropagation();\n      var minCharacters = _this.props.minCharacters;\n      var open = _this.state.open;\n      var newQuery = e.target.value;\n\n      _invoke(_this.props, 'onSearchChange', e, _extends({}, _this.props, {\n        value: newQuery\n      })); // open search dropdown on search query\n\n\n      if (newQuery.length < minCharacters) {\n        _this.close();\n      } else if (!open) {\n        _this.tryOpen(newQuery);\n      }\n\n      _this.setValue(newQuery);\n    }, _this.getFlattenedResults = function () {\n      var _this$props = _this.props,\n          category = _this$props.category,\n          results = _this$props.results;\n      return !category ? results : _reduce(results, function (memo, categoryData) {\n        return memo.concat(categoryData.results);\n      }, []);\n    }, _this.getSelectedResult = function () {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this.state.selectedIndex;\n\n      var results = _this.getFlattenedResults();\n\n      return _get(results, index);\n    }, _this.setValue = function (value) {\n      var selectFirstResult = _this.props.selectFirstResult;\n\n      _this.trySetState({\n        value: value\n      }, {\n        selectedIndex: selectFirstResult ? 0 : -1\n      });\n    }, _this.moveSelectionBy = function (e, offset) {\n      var selectedIndex = _this.state.selectedIndex;\n\n      var results = _this.getFlattenedResults();\n\n      var lastIndex = results.length - 1; // next is after last, wrap to beginning\n      // next is before first, wrap to end\n\n      var nextIndex = selectedIndex + offset;\n      if (nextIndex > lastIndex) nextIndex = 0;else if (nextIndex < 0) nextIndex = lastIndex;\n\n      _this.setState({\n        selectedIndex: nextIndex\n      });\n\n      _this.scrollSelectedItemIntoView();\n\n      _this.handleSelectionChange(e);\n    }, _this.scrollSelectedItemIntoView = function () {\n      // Do not access document when server side rendering\n      if (!isBrowser()) return;\n      var menu = document.querySelector('.ui.search.active.visible .results.visible');\n      var item = menu.querySelector('.result.active');\n      if (!item) return;\n      var isOutOfUpperView = item.offsetTop < menu.scrollTop;\n      var isOutOfLowerView = item.offsetTop + item.clientHeight > menu.scrollTop + menu.clientHeight;\n\n      if (isOutOfUpperView) {\n        menu.scrollTop = item.offsetTop;\n      } else if (isOutOfLowerView) {\n        menu.scrollTop = item.offsetTop + item.clientHeight - menu.clientHeight;\n      }\n    }, _this.tryOpen = function () {\n      var currentValue = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this.state.value;\n      var minCharacters = _this.props.minCharacters;\n      if (currentValue.length < minCharacters) return;\n\n      _this.open();\n    }, _this.open = function () {\n      _this.trySetState({\n        open: true\n      });\n    }, _this.close = function () {\n      _this.trySetState({\n        open: false\n      });\n    }, _this.renderSearchInput = function (rest) {\n      var _this$props2 = _this.props,\n          icon = _this$props2.icon,\n          input = _this$props2.input;\n      var value = _this.state.value;\n      return Input.create(input, {\n        defaultProps: _extends({}, rest, {\n          icon: icon,\n          input: {\n            className: 'prompt',\n            tabIndex: '0',\n            autoComplete: 'off'\n          },\n          onChange: _this.handleSearchChange,\n          onClick: _this.handleInputClick,\n          value: value\n        })\n      });\n    }, _this.renderNoResults = function () {\n      var _this$props3 = _this.props,\n          noResultsDescription = _this$props3.noResultsDescription,\n          noResultsMessage = _this$props3.noResultsMessage;\n      return React.createElement('div', {\n        className: 'message empty'\n      }, React.createElement('div', {\n        className: 'header'\n      }, noResultsMessage), noResultsDescription && React.createElement('div', {\n        className: 'description'\n      }, noResultsDescription));\n    }, _this.renderResult = function (_ref3, index, _array) {\n      var offset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n\n      var childKey = _ref3.childKey,\n          result = _objectWithoutProperties(_ref3, ['childKey']);\n\n      var resultRenderer = _this.props.resultRenderer;\n      var selectedIndex = _this.state.selectedIndex;\n      var offsetIndex = index + offset;\n      return React.createElement(SearchResult, _extends({\n        key: childKey || result.title,\n        active: selectedIndex === offsetIndex,\n        onClick: _this.handleItemClick,\n        renderer: resultRenderer\n      }, result, {\n        id: offsetIndex // Used to lookup the result on item click\n\n      }));\n    }, _this.renderResults = function () {\n      var results = _this.props.results;\n      return _map(results, _this.renderResult);\n    }, _this.renderCategories = function () {\n      var _this$props4 = _this.props,\n          categoryRenderer = _this$props4.categoryRenderer,\n          categories = _this$props4.results;\n      var selectedIndex = _this.state.selectedIndex;\n      var count = 0;\n      return _map(categories, function (_ref4) {\n        var childKey = _ref4.childKey,\n            category = _objectWithoutProperties(_ref4, ['childKey']);\n\n        var categoryProps = _extends({\n          key: childKey || category.name,\n          active: _inRange(selectedIndex, count, count + category.results.length),\n          renderer: categoryRenderer\n        }, category);\n\n        var renderFn = _partialRight(_this.renderResult, count);\n\n        count += category.results.length;\n        return React.createElement(SearchCategory, categoryProps, category.results.map(renderFn));\n      });\n    }, _this.renderMenuContent = function () {\n      var _this$props5 = _this.props,\n          category = _this$props5.category,\n          showNoResults = _this$props5.showNoResults,\n          results = _this$props5.results;\n\n      if (_isEmpty(results)) {\n        return showNoResults ? _this.renderNoResults() : null;\n      }\n\n      return category ? _this.renderCategories() : _this.renderResults();\n    }, _this.renderResultsMenu = function () {\n      var open = _this.state.open;\n      var resultsClasses = open ? 'visible' : '';\n\n      var menuContent = _this.renderMenuContent();\n\n      if (!menuContent) return;\n      return React.createElement(SearchResults, {\n        className: resultsClasses\n      }, menuContent);\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Search, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      var _state = this.state,\n          open = _state.open,\n          value = _state.value;\n      this.setValue(value);\n      if (open) this.open();\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      _get2(Search.prototype.__proto__ || Object.getPrototypeOf(Search.prototype), 'componentWillReceiveProps', this).call(this, nextProps);\n\n      if (!shallowEqual(nextProps.value, this.props.value)) {\n        this.setValue(nextProps.value);\n      }\n    }\n  }, {\n    key: 'shouldComponentUpdate',\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      return !shallowEqual(nextProps, this.props) || !shallowEqual(nextState, this.state);\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      // focused / blurred\n      // eslint-disable-line complexity\n      if (!prevState.focus && this.state.focus) {\n        if (!this.isMouseDown) {\n          this.tryOpen();\n        }\n\n        if (this.state.open) {\n          eventStack.sub('keydown', [this.moveSelectionOnKeyDown, this.selectItemOnEnter]);\n        }\n      } else if (prevState.focus && !this.state.focus) {\n        if (!this.isMouseDown) {\n          this.close();\n        }\n\n        eventStack.unsub('keydown', [this.moveSelectionOnKeyDown, this.selectItemOnEnter]);\n      } // opened / closed\n\n\n      if (!prevState.open && this.state.open) {\n        this.open();\n        eventStack.sub('click', this.closeOnDocumentClick);\n        eventStack.sub('keydown', [this.closeOnEscape, this.moveSelectionOnKeyDown, this.selectItemOnEnter]);\n      } else if (prevState.open && !this.state.open) {\n        this.close();\n        eventStack.unsub('click', this.closeOnDocumentClick);\n        eventStack.unsub('keydown', [this.closeOnEscape, this.moveSelectionOnKeyDown, this.selectItemOnEnter]);\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      eventStack.unsub('click', this.closeOnDocumentClick);\n      eventStack.unsub('keydown', [this.closeOnEscape, this.moveSelectionOnKeyDown, this.selectItemOnEnter]);\n    } // ----------------------------------------\n    // Document Event Handlers\n    // ----------------------------------------\n    // ----------------------------------------\n    // Component Event Handlers\n    // ----------------------------------------\n    // ----------------------------------------\n    // Getters\n    // ----------------------------------------\n    // ----------------------------------------\n    // Setters\n    // ----------------------------------------\n    // ----------------------------------------\n    // Behavior\n    // ----------------------------------------\n    // Open if the current value is greater than the minCharacters prop\n    // ----------------------------------------\n    // Render\n    // ----------------------------------------\n\n    /**\n     * Offset is needed for determining the active item for results within a\n     * category. Since the index is reset to 0 for each new category, an offset\n     * must be passed in.\n     */\n\n  }, {\n    key: 'render',\n    value: function render() {\n      var _state2 = this.state,\n          searchClasses = _state2.searchClasses,\n          focus = _state2.focus,\n          open = _state2.open;\n      var _props = this.props,\n          aligned = _props.aligned,\n          category = _props.category,\n          className = _props.className,\n          fluid = _props.fluid,\n          loading = _props.loading,\n          size = _props.size; // Classes\n\n      var classes = cx('ui', open && 'active visible', size, searchClasses, useKeyOnly(category, 'category'), useKeyOnly(focus, 'focus'), useKeyOnly(fluid, 'fluid'), useKeyOnly(loading, 'loading'), useValueAndKey(aligned, 'aligned'), 'search', className);\n      var unhandled = getUnhandledProps(Search, this.props);\n      var ElementType = getElementType(Search, this.props);\n\n      var _partitionHTMLProps = partitionHTMLProps(unhandled, {\n        htmlProps: htmlInputAttrs\n      }),\n          _partitionHTMLProps2 = _slicedToArray(_partitionHTMLProps, 2),\n          htmlInputProps = _partitionHTMLProps2[0],\n          rest = _partitionHTMLProps2[1];\n\n      return React.createElement(ElementType, _extends({}, rest, {\n        className: classes,\n        onBlur: this.handleBlur,\n        onFocus: this.handleFocus,\n        onMouseDown: this.handleMouseDown\n      }), this.renderSearchInput(htmlInputProps), this.renderResultsMenu());\n    }\n  }]);\n\n  return Search;\n}(Component);\n\nSearch.defaultProps = {\n  icon: 'search',\n  input: 'text',\n  minCharacters: 1,\n  noResultsMessage: 'No results found.',\n  showNoResults: true\n};\nSearch.autoControlledProps = ['open', 'value'];\nSearch._meta = {\n  name: 'Search',\n  type: META.TYPES.MODULE\n};\nSearch.Category = SearchCategory;\nSearch.Result = SearchResult;\nSearch.Results = SearchResults;\nSearch.handledProps = ['aligned', 'as', 'category', 'categoryRenderer', 'className', 'defaultOpen', 'defaultValue', 'fluid', 'icon', 'input', 'loading', 'minCharacters', 'noResultsDescription', 'noResultsMessage', 'onBlur', 'onFocus', 'onMouseDown', 'onResultSelect', 'onSearchChange', 'onSelectionChange', 'open', 'resultRenderer', 'results', 'selectFirstResult', 'showNoResults', 'size', 'value'];\nexport default Search;\nSearch.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /** An element type to render as (string or function). */\n  as: customPropTypes.as,\n  // ------------------------------------\n  // Behavior\n  // ------------------------------------\n\n  /** Initial value of open. */\n  defaultOpen: PropTypes.bool,\n\n  /** Initial value. */\n  defaultValue: PropTypes.string,\n\n  /** Shorthand for Icon. */\n  icon: PropTypes.oneOfType([PropTypes.node, PropTypes.object]),\n\n  /** Minimum characters to query for results */\n  minCharacters: PropTypes.number,\n\n  /** Additional text for \"No Results\" message with less emphasis. */\n  noResultsDescription: PropTypes.node,\n\n  /** Message to display when there are no results. */\n  noResultsMessage: PropTypes.node,\n\n  /** Controls whether or not the results menu is displayed. */\n  open: PropTypes.bool,\n\n  /**\n   * One of:\n   * - array of Search.Result props e.g. `{ title: '', description: '' }` or\n   * - object of categories e.g. `{ name: '', results: [{ title: '', description: '' }]`\n   */\n  results: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.shape(SearchResult.propTypes)), PropTypes.object]),\n\n  /** Whether the search should automatically select the first result after searching. */\n  selectFirstResult: PropTypes.bool,\n\n  /** Whether a \"no results\" message should be shown if no results are found. */\n  showNoResults: PropTypes.bool,\n\n  /** Current value of the search input. Creates a controlled component. */\n  value: PropTypes.string,\n  // ------------------------------------\n  // Rendering\n  // ------------------------------------\n\n  /**\n   * Renders the SearchCategory contents.\n   *\n   * @param {object} props - The SearchCategory props object.\n   * @returns {*} - Renderable SearchCategory contents.\n   */\n  categoryRenderer: PropTypes.func,\n\n  /**\n   * Renders the SearchResult contents.\n   *\n   * @param {object} props - The SearchResult props object.\n   * @returns {*} - Renderable SearchResult contents.\n   */\n  resultRenderer: PropTypes.func,\n  // ------------------------------------\n  // Callbacks\n  // ------------------------------------\n\n  /**\n   * Called on blur.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onBlur: PropTypes.func,\n\n  /**\n   * Called on focus.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onFocus: PropTypes.func,\n\n  /**\n   * Called on mousedown.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onMouseDown: PropTypes.func,\n\n  /**\n   * Called when a result is selected.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onResultSelect: PropTypes.func,\n\n  /**\n   * Called on search input change.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props, includes current value of search input.\n   */\n  onSearchChange: PropTypes.func,\n\n  /**\n   * Called when the active selection index is changed.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onSelectionChange: PropTypes.func,\n  // ------------------------------------\n  // Style\n  // ------------------------------------\n\n  /** A search can have its results aligned to its left or right container edge. */\n  aligned: PropTypes.string,\n\n  /** A search can display results from remote content ordered by categories. */\n  category: PropTypes.bool,\n\n  /** Additional classes. */\n  className: PropTypes.string,\n\n  /** A search can have its results take up the width of its container. */\n  fluid: PropTypes.bool,\n\n  /** A search input can take up the width of its container. */\n  input: customPropTypes.itemShorthand,\n\n  /** A search can show a loading indicator. */\n  loading: PropTypes.bool,\n\n  /** A search can have different sizes. */\n  size: PropTypes.oneOf(_without(SUI.SIZES, 'medium'))\n} : {};","map":{"version":3,"sources":["/Users/bly/Documents/工作/实验室/项目/医疗系统/PACS/pacs/node_modules/semantic-ui-react/dist/es/modules/Search/Search.js"],"names":["_slicedToArray","_objectWithoutProperties","_extends","_classCallCheck","_createClass","_possibleConstructorReturn","_get2","_inherits","_isEmpty","_partialRight","_inRange","_map","_get","_reduce","_invoke","_without","cx","PropTypes","React","AutoControlledComponent","Component","customPropTypes","eventStack","getElementType","getUnhandledProps","htmlInputAttrs","isBrowser","keyboardKey","META","objectDiff","partitionHTMLProps","shallowEqual","SUI","useKeyOnly","useValueAndKey","Input","SearchCategory","SearchResult","SearchResults","Search","_Component","_ref","_temp","_this","_ret","_len","arguments","length","args","Array","_key","__proto__","Object","getPrototypeOf","call","apply","concat","handleResultSelect","e","result","props","handleSelectionChange","getSelectedResult","closeOnEscape","getCode","Escape","preventDefault","close","moveSelectionOnKeyDown","ArrowDown","moveSelectionBy","ArrowUp","selectItemOnEnter","Enter","setValue","title","closeOnDocumentClick","handleMouseDown","isMouseDown","sub","handleDocumentMouseUp","unsub","handleInputClick","nativeEvent","stopImmediatePropagation","tryOpen","handleItemClick","_ref2","id","handleFocus","onFocus","setState","focus","handleBlur","onBlur","handleSearchChange","stopPropagation","minCharacters","open","state","newQuery","target","value","getFlattenedResults","_this$props","category","results","memo","categoryData","index","undefined","selectedIndex","selectFirstResult","trySetState","offset","lastIndex","nextIndex","scrollSelectedItemIntoView","menu","document","querySelector","item","isOutOfUpperView","offsetTop","scrollTop","isOutOfLowerView","clientHeight","currentValue","renderSearchInput","rest","_this$props2","icon","input","create","defaultProps","className","tabIndex","autoComplete","onChange","onClick","renderNoResults","_this$props3","noResultsDescription","noResultsMessage","createElement","renderResult","_ref3","_array","childKey","resultRenderer","offsetIndex","key","active","renderer","renderResults","renderCategories","_this$props4","categoryRenderer","categories","count","_ref4","categoryProps","name","renderFn","map","renderMenuContent","_this$props5","showNoResults","renderResultsMenu","resultsClasses","menuContent","componentWillMount","_state","componentWillReceiveProps","nextProps","prototype","shouldComponentUpdate","nextState","componentDidUpdate","prevProps","prevState","componentWillUnmount","render","_state2","searchClasses","_props","aligned","fluid","loading","size","classes","unhandled","ElementType","_partitionHTMLProps","htmlProps","_partitionHTMLProps2","htmlInputProps","onMouseDown","autoControlledProps","_meta","type","TYPES","MODULE","Category","Result","Results","handledProps","propTypes","process","env","NODE_ENV","as","defaultOpen","bool","defaultValue","string","oneOfType","node","object","number","arrayOf","shape","func","onResultSelect","onSearchChange","onSelectionChange","itemShorthand","oneOf","SIZES"],"mappings":"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","sourcesContent":["import _slicedToArray from 'babel-runtime/helpers/slicedToArray';\nimport _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _get2 from 'babel-runtime/helpers/get';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport _isEmpty from 'lodash/isEmpty';\nimport _partialRight from 'lodash/partialRight';\nimport _inRange from 'lodash/inRange';\nimport _map from 'lodash/map';\nimport _get from 'lodash/get';\nimport _reduce from 'lodash/reduce';\nimport _invoke from 'lodash/invoke';\nimport _without from 'lodash/without';\nimport cx from 'classnames';\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nimport { AutoControlledComponent as Component, customPropTypes, eventStack, getElementType, getUnhandledProps, htmlInputAttrs, isBrowser, keyboardKey, META, objectDiff, partitionHTMLProps, shallowEqual, SUI, useKeyOnly, useValueAndKey } from '../../lib';\nimport Input from '../../elements/Input';\nimport SearchCategory from './SearchCategory';\nimport SearchResult from './SearchResult';\nimport SearchResults from './SearchResults';\n\n/**\n * A search module allows a user to query for results from a selection of data\n */\nvar Search = function (_Component) {\n  _inherits(Search, _Component);\n\n  function Search() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Search);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Search.__proto__ || Object.getPrototypeOf(Search)).call.apply(_ref, [this].concat(args))), _this), _this.handleResultSelect = function (e, result) {\n\n      _invoke(_this.props, 'onResultSelect', e, _extends({}, _this.props, { result: result }));\n    }, _this.handleSelectionChange = function (e) {\n\n      var result = _this.getSelectedResult();\n      _invoke(_this.props, 'onSelectionChange', e, _extends({}, _this.props, { result: result }));\n    }, _this.closeOnEscape = function (e) {\n      if (keyboardKey.getCode(e) !== keyboardKey.Escape) return;\n      e.preventDefault();\n      _this.close();\n    }, _this.moveSelectionOnKeyDown = function (e) {\n      switch (keyboardKey.getCode(e)) {\n        case keyboardKey.ArrowDown:\n          e.preventDefault();\n          _this.moveSelectionBy(e, 1);\n          break;\n        case keyboardKey.ArrowUp:\n          e.preventDefault();\n          _this.moveSelectionBy(e, -1);\n          break;\n        default:\n          break;\n      }\n    }, _this.selectItemOnEnter = function (e) {\n      if (keyboardKey.getCode(e) !== keyboardKey.Enter) return;\n\n      var result = _this.getSelectedResult();\n\n      // prevent selecting null if there was no selected item value\n      if (!result) return;\n\n      e.preventDefault();\n\n      // notify the onResultSelect prop that the user is trying to change value\n      _this.setValue(result.title);\n      _this.handleResultSelect(e, result);\n      _this.close();\n    }, _this.closeOnDocumentClick = function (e) {\n      _this.close();\n    }, _this.handleMouseDown = function (e) {\n\n      _this.isMouseDown = true;\n      _invoke(_this.props, 'onMouseDown', e, _this.props);\n      eventStack.sub('mouseup', _this.handleDocumentMouseUp);\n    }, _this.handleDocumentMouseUp = function () {\n\n      _this.isMouseDown = false;\n      eventStack.unsub('mouseup', _this.handleDocumentMouseUp);\n    }, _this.handleInputClick = function (e) {\n\n      // prevent closeOnDocumentClick()\n      e.nativeEvent.stopImmediatePropagation();\n\n      _this.tryOpen();\n    }, _this.handleItemClick = function (e, _ref2) {\n      var id = _ref2.id;\n\n      var result = _this.getSelectedResult(id);\n\n      // prevent closeOnDocumentClick()\n      e.nativeEvent.stopImmediatePropagation();\n\n      // notify the onResultSelect prop that the user is trying to change value\n      _this.setValue(result.title);\n      _this.handleResultSelect(e, result);\n      _this.close();\n    }, _this.handleFocus = function (e) {\n      var onFocus = _this.props.onFocus;\n\n      if (onFocus) onFocus(e, _this.props);\n      _this.setState({ focus: true });\n    }, _this.handleBlur = function (e) {\n      var onBlur = _this.props.onBlur;\n\n      if (onBlur) onBlur(e, _this.props);\n      _this.setState({ focus: false });\n    }, _this.handleSearchChange = function (e) {\n      // prevent propagating to this.props.onChange()\n      e.stopPropagation();\n      var minCharacters = _this.props.minCharacters;\n      var open = _this.state.open;\n\n      var newQuery = e.target.value;\n\n      _invoke(_this.props, 'onSearchChange', e, _extends({}, _this.props, { value: newQuery }));\n\n      // open search dropdown on search query\n      if (newQuery.length < minCharacters) {\n        _this.close();\n      } else if (!open) {\n        _this.tryOpen(newQuery);\n      }\n\n      _this.setValue(newQuery);\n    }, _this.getFlattenedResults = function () {\n      var _this$props = _this.props,\n          category = _this$props.category,\n          results = _this$props.results;\n\n\n      return !category ? results : _reduce(results, function (memo, categoryData) {\n        return memo.concat(categoryData.results);\n      }, []);\n    }, _this.getSelectedResult = function () {\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this.state.selectedIndex;\n\n      var results = _this.getFlattenedResults();\n      return _get(results, index);\n    }, _this.setValue = function (value) {\n      var selectFirstResult = _this.props.selectFirstResult;\n\n\n      _this.trySetState({ value: value }, { selectedIndex: selectFirstResult ? 0 : -1 });\n    }, _this.moveSelectionBy = function (e, offset) {\n      var selectedIndex = _this.state.selectedIndex;\n\n\n      var results = _this.getFlattenedResults();\n      var lastIndex = results.length - 1;\n\n      // next is after last, wrap to beginning\n      // next is before first, wrap to end\n      var nextIndex = selectedIndex + offset;\n      if (nextIndex > lastIndex) nextIndex = 0;else if (nextIndex < 0) nextIndex = lastIndex;\n\n      _this.setState({ selectedIndex: nextIndex });\n      _this.scrollSelectedItemIntoView();\n      _this.handleSelectionChange(e);\n    }, _this.scrollSelectedItemIntoView = function () {\n      // Do not access document when server side rendering\n      if (!isBrowser()) return;\n      var menu = document.querySelector('.ui.search.active.visible .results.visible');\n      var item = menu.querySelector('.result.active');\n      if (!item) return;\n\n      var isOutOfUpperView = item.offsetTop < menu.scrollTop;\n      var isOutOfLowerView = item.offsetTop + item.clientHeight > menu.scrollTop + menu.clientHeight;\n\n      if (isOutOfUpperView) {\n        menu.scrollTop = item.offsetTop;\n      } else if (isOutOfLowerView) {\n        menu.scrollTop = item.offsetTop + item.clientHeight - menu.clientHeight;\n      }\n    }, _this.tryOpen = function () {\n      var currentValue = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this.state.value;\n      var minCharacters = _this.props.minCharacters;\n\n      if (currentValue.length < minCharacters) return;\n\n      _this.open();\n    }, _this.open = function () {\n      _this.trySetState({ open: true });\n    }, _this.close = function () {\n      _this.trySetState({ open: false });\n    }, _this.renderSearchInput = function (rest) {\n      var _this$props2 = _this.props,\n          icon = _this$props2.icon,\n          input = _this$props2.input;\n      var value = _this.state.value;\n\n\n      return Input.create(input, { defaultProps: _extends({}, rest, {\n          icon: icon,\n          input: { className: 'prompt', tabIndex: '0', autoComplete: 'off' },\n          onChange: _this.handleSearchChange,\n          onClick: _this.handleInputClick,\n          value: value\n        }) });\n    }, _this.renderNoResults = function () {\n      var _this$props3 = _this.props,\n          noResultsDescription = _this$props3.noResultsDescription,\n          noResultsMessage = _this$props3.noResultsMessage;\n\n\n      return React.createElement(\n        'div',\n        { className: 'message empty' },\n        React.createElement(\n          'div',\n          { className: 'header' },\n          noResultsMessage\n        ),\n        noResultsDescription && React.createElement(\n          'div',\n          { className: 'description' },\n          noResultsDescription\n        )\n      );\n    }, _this.renderResult = function (_ref3, index, _array) {\n      var offset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n\n      var childKey = _ref3.childKey,\n          result = _objectWithoutProperties(_ref3, ['childKey']);\n\n      var resultRenderer = _this.props.resultRenderer;\n      var selectedIndex = _this.state.selectedIndex;\n\n      var offsetIndex = index + offset;\n\n      return React.createElement(SearchResult, _extends({\n        key: childKey || result.title,\n        active: selectedIndex === offsetIndex,\n        onClick: _this.handleItemClick,\n        renderer: resultRenderer\n      }, result, {\n        id: offsetIndex // Used to lookup the result on item click\n      }));\n    }, _this.renderResults = function () {\n      var results = _this.props.results;\n\n\n      return _map(results, _this.renderResult);\n    }, _this.renderCategories = function () {\n      var _this$props4 = _this.props,\n          categoryRenderer = _this$props4.categoryRenderer,\n          categories = _this$props4.results;\n      var selectedIndex = _this.state.selectedIndex;\n\n\n      var count = 0;\n\n      return _map(categories, function (_ref4) {\n        var childKey = _ref4.childKey,\n            category = _objectWithoutProperties(_ref4, ['childKey']);\n\n        var categoryProps = _extends({\n          key: childKey || category.name,\n          active: _inRange(selectedIndex, count, count + category.results.length),\n          renderer: categoryRenderer\n        }, category);\n        var renderFn = _partialRight(_this.renderResult, count);\n\n        count += category.results.length;\n\n        return React.createElement(\n          SearchCategory,\n          categoryProps,\n          category.results.map(renderFn)\n        );\n      });\n    }, _this.renderMenuContent = function () {\n      var _this$props5 = _this.props,\n          category = _this$props5.category,\n          showNoResults = _this$props5.showNoResults,\n          results = _this$props5.results;\n\n\n      if (_isEmpty(results)) {\n        return showNoResults ? _this.renderNoResults() : null;\n      }\n\n      return category ? _this.renderCategories() : _this.renderResults();\n    }, _this.renderResultsMenu = function () {\n      var open = _this.state.open;\n\n      var resultsClasses = open ? 'visible' : '';\n      var menuContent = _this.renderMenuContent();\n\n      if (!menuContent) return;\n\n      return React.createElement(\n        SearchResults,\n        { className: resultsClasses },\n        menuContent\n      );\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Search, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      var _state = this.state,\n          open = _state.open,\n          value = _state.value;\n\n\n      this.setValue(value);\n      if (open) this.open();\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      _get2(Search.prototype.__proto__ || Object.getPrototypeOf(Search.prototype), 'componentWillReceiveProps', this).call(this, nextProps);\n\n\n      if (!shallowEqual(nextProps.value, this.props.value)) {\n        this.setValue(nextProps.value);\n      }\n    }\n  }, {\n    key: 'shouldComponentUpdate',\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      return !shallowEqual(nextProps, this.props) || !shallowEqual(nextState, this.state);\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n\n      // focused / blurred\n      // eslint-disable-line complexity\n      if (!prevState.focus && this.state.focus) {\n        if (!this.isMouseDown) {\n          this.tryOpen();\n        }\n        if (this.state.open) {\n          eventStack.sub('keydown', [this.moveSelectionOnKeyDown, this.selectItemOnEnter]);\n        }\n      } else if (prevState.focus && !this.state.focus) {\n        if (!this.isMouseDown) {\n          this.close();\n        }\n        eventStack.unsub('keydown', [this.moveSelectionOnKeyDown, this.selectItemOnEnter]);\n      }\n\n      // opened / closed\n      if (!prevState.open && this.state.open) {\n        this.open();\n        eventStack.sub('click', this.closeOnDocumentClick);\n        eventStack.sub('keydown', [this.closeOnEscape, this.moveSelectionOnKeyDown, this.selectItemOnEnter]);\n      } else if (prevState.open && !this.state.open) {\n        this.close();\n        eventStack.unsub('click', this.closeOnDocumentClick);\n        eventStack.unsub('keydown', [this.closeOnEscape, this.moveSelectionOnKeyDown, this.selectItemOnEnter]);\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n\n      eventStack.unsub('click', this.closeOnDocumentClick);\n      eventStack.unsub('keydown', [this.closeOnEscape, this.moveSelectionOnKeyDown, this.selectItemOnEnter]);\n    }\n\n    // ----------------------------------------\n    // Document Event Handlers\n    // ----------------------------------------\n\n    // ----------------------------------------\n    // Component Event Handlers\n    // ----------------------------------------\n\n    // ----------------------------------------\n    // Getters\n    // ----------------------------------------\n\n    // ----------------------------------------\n    // Setters\n    // ----------------------------------------\n\n    // ----------------------------------------\n    // Behavior\n    // ----------------------------------------\n\n    // Open if the current value is greater than the minCharacters prop\n\n\n    // ----------------------------------------\n    // Render\n    // ----------------------------------------\n\n    /**\n     * Offset is needed for determining the active item for results within a\n     * category. Since the index is reset to 0 for each new category, an offset\n     * must be passed in.\n     */\n\n  }, {\n    key: 'render',\n    value: function render() {\n      var _state2 = this.state,\n          searchClasses = _state2.searchClasses,\n          focus = _state2.focus,\n          open = _state2.open;\n      var _props = this.props,\n          aligned = _props.aligned,\n          category = _props.category,\n          className = _props.className,\n          fluid = _props.fluid,\n          loading = _props.loading,\n          size = _props.size;\n\n      // Classes\n\n      var classes = cx('ui', open && 'active visible', size, searchClasses, useKeyOnly(category, 'category'), useKeyOnly(focus, 'focus'), useKeyOnly(fluid, 'fluid'), useKeyOnly(loading, 'loading'), useValueAndKey(aligned, 'aligned'), 'search', className);\n      var unhandled = getUnhandledProps(Search, this.props);\n      var ElementType = getElementType(Search, this.props);\n\n      var _partitionHTMLProps = partitionHTMLProps(unhandled, {\n        htmlProps: htmlInputAttrs\n      }),\n          _partitionHTMLProps2 = _slicedToArray(_partitionHTMLProps, 2),\n          htmlInputProps = _partitionHTMLProps2[0],\n          rest = _partitionHTMLProps2[1];\n\n      return React.createElement(\n        ElementType,\n        _extends({}, rest, {\n          className: classes,\n          onBlur: this.handleBlur,\n          onFocus: this.handleFocus,\n          onMouseDown: this.handleMouseDown\n        }),\n        this.renderSearchInput(htmlInputProps),\n        this.renderResultsMenu()\n      );\n    }\n  }]);\n\n  return Search;\n}(Component);\n\nSearch.defaultProps = {\n  icon: 'search',\n  input: 'text',\n  minCharacters: 1,\n  noResultsMessage: 'No results found.',\n  showNoResults: true\n};\nSearch.autoControlledProps = ['open', 'value'];\nSearch._meta = {\n  name: 'Search',\n  type: META.TYPES.MODULE\n};\nSearch.Category = SearchCategory;\nSearch.Result = SearchResult;\nSearch.Results = SearchResults;\nSearch.handledProps = ['aligned', 'as', 'category', 'categoryRenderer', 'className', 'defaultOpen', 'defaultValue', 'fluid', 'icon', 'input', 'loading', 'minCharacters', 'noResultsDescription', 'noResultsMessage', 'onBlur', 'onFocus', 'onMouseDown', 'onResultSelect', 'onSearchChange', 'onSelectionChange', 'open', 'resultRenderer', 'results', 'selectFirstResult', 'showNoResults', 'size', 'value'];\nexport default Search;\nSearch.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /** An element type to render as (string or function). */\n  as: customPropTypes.as,\n\n  // ------------------------------------\n  // Behavior\n  // ------------------------------------\n\n  /** Initial value of open. */\n  defaultOpen: PropTypes.bool,\n\n  /** Initial value. */\n  defaultValue: PropTypes.string,\n\n  /** Shorthand for Icon. */\n  icon: PropTypes.oneOfType([PropTypes.node, PropTypes.object]),\n\n  /** Minimum characters to query for results */\n  minCharacters: PropTypes.number,\n\n  /** Additional text for \"No Results\" message with less emphasis. */\n  noResultsDescription: PropTypes.node,\n\n  /** Message to display when there are no results. */\n  noResultsMessage: PropTypes.node,\n\n  /** Controls whether or not the results menu is displayed. */\n  open: PropTypes.bool,\n\n  /**\n   * One of:\n   * - array of Search.Result props e.g. `{ title: '', description: '' }` or\n   * - object of categories e.g. `{ name: '', results: [{ title: '', description: '' }]`\n   */\n  results: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.shape(SearchResult.propTypes)), PropTypes.object]),\n\n  /** Whether the search should automatically select the first result after searching. */\n  selectFirstResult: PropTypes.bool,\n\n  /** Whether a \"no results\" message should be shown if no results are found. */\n  showNoResults: PropTypes.bool,\n\n  /** Current value of the search input. Creates a controlled component. */\n  value: PropTypes.string,\n\n  // ------------------------------------\n  // Rendering\n  // ------------------------------------\n\n  /**\n   * Renders the SearchCategory contents.\n   *\n   * @param {object} props - The SearchCategory props object.\n   * @returns {*} - Renderable SearchCategory contents.\n   */\n  categoryRenderer: PropTypes.func,\n\n  /**\n   * Renders the SearchResult contents.\n   *\n   * @param {object} props - The SearchResult props object.\n   * @returns {*} - Renderable SearchResult contents.\n   */\n  resultRenderer: PropTypes.func,\n\n  // ------------------------------------\n  // Callbacks\n  // ------------------------------------\n\n  /**\n   * Called on blur.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onBlur: PropTypes.func,\n\n  /**\n   * Called on focus.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onFocus: PropTypes.func,\n\n  /**\n   * Called on mousedown.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onMouseDown: PropTypes.func,\n\n  /**\n   * Called when a result is selected.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onResultSelect: PropTypes.func,\n\n  /**\n   * Called on search input change.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props, includes current value of search input.\n   */\n  onSearchChange: PropTypes.func,\n\n  /**\n   * Called when the active selection index is changed.\n   *\n   * @param {SyntheticEvent} event - React's original SyntheticEvent.\n   * @param {object} data - All props.\n   */\n  onSelectionChange: PropTypes.func,\n\n  // ------------------------------------\n  // Style\n  // ------------------------------------\n\n  /** A search can have its results aligned to its left or right container edge. */\n  aligned: PropTypes.string,\n\n  /** A search can display results from remote content ordered by categories. */\n  category: PropTypes.bool,\n\n  /** Additional classes. */\n  className: PropTypes.string,\n\n  /** A search can have its results take up the width of its container. */\n  fluid: PropTypes.bool,\n\n  /** A search input can take up the width of its container. */\n  input: customPropTypes.itemShorthand,\n\n  /** A search can show a loading indicator. */\n  loading: PropTypes.bool,\n\n  /** A search can have different sizes. */\n  size: PropTypes.oneOf(_without(SUI.SIZES, 'medium'))\n} : {};"]},"metadata":{},"sourceType":"module"}